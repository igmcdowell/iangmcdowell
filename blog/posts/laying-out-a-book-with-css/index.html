<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Laying Out a Print Book With CSS | Ian G McDowell&#39;s Blog</title>
<meta name="keywords" content="writing, technology" />
<meta name="description" content="In which I embark on a quixotic quest to make a physical book using web rendering technology.">
<meta name="author" content="">
<link rel="canonical" href="https://iangmcdowell.com/blog/posts/laying-out-a-book-with-css/" />
<link crossorigin="anonymous" href="/blog/assets/css/stylesheet.min.e7a81240c3569cffba19790e2d446f0037f74cd61a5ec016a1a85b0a72d417a0.css" integrity="sha256-56gSQMNWnP&#43;6GXkOLURvADf3TNYaXsAWoahbCnLUF6A=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/blog/assets/js/highlight.min.b95bacdc39e37a332a9f883b1e78be4abc1fdca2bc1f2641f55e3cd3dabd4d61.js" integrity="sha256-uVus3DnjejMqn4g7Hni&#43;Srwf3KK8HyZB9V4809q9TWE="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://iangmcdowell.com/blog/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://iangmcdowell.com/blog/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://iangmcdowell.com/blog/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://iangmcdowell.com/blog/apple-touch-icon.png">
<link rel="mask-icon" href="https://iangmcdowell.com/blog/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.104.3" />
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Laying Out a Print Book With CSS" />
<meta property="og:description" content="In which I embark on a quixotic quest to make a physical book using web rendering technology." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://iangmcdowell.com/blog/posts/laying-out-a-book-with-css/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-19T20:06:35-08:00" />
<meta property="article:modified_time" content="2023-03-19T20:06:35-08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Laying Out a Print Book With CSS"/>
<meta name="twitter:description" content="In which I embark on a quixotic quest to make a physical book using web rendering technology."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Posts",
      "item": "https://iangmcdowell.com/blog/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "Laying Out a Print Book With CSS",
      "item": "https://iangmcdowell.com/blog/posts/laying-out-a-book-with-css/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Laying Out a Print Book With CSS",
  "name": "Laying Out a Print Book With CSS",
  "description": "In which I embark on a quixotic quest to make a physical book using web rendering technology.",
  "keywords": [
    "writing", "technology"
  ],
  "articleBody": " Obligatory Stable Diffusion image\nLast year I published my debut technothriller, The Anshar Gambit, as an eBook. Satisfying, yes, but I’ve spent entirely too much of my life peddling bits. I wanted to hold it. Unsurprisingly, in order to get my book printed, I first needed to submit a pixel-perfect PDF of all the pages. And like any self-respecting nerd, I approached the challenge in the most convoluted way possible.\nThe sane way to do it As you might expect, laying out a book is a solved problem. The simplest solution is to pay a professional. But I have ample time to learn and limited budget, so I wanted a DIY solution.\nMost self-publishers use software explicitly built for this task. Vellum is the gold standard. It is very good and easy to use, and costs just $250. Another contender is Atticus, which is pitched as an all-in-one writing platform for a more affordable $147. These are both good options, and while expensive for software, reasonable for the amount of time they save you. But I am a fool with more time than sense/cents, and I knew I could do it cheaper.\nReedsy offers an online tool that supports a basic print layout. And it’s free! That got my attention. I got as far as loading my manuscript into their tool, but hit a rendering bug displaying Latin Extended-A characters in a code-block, plus there were some other minor formatting glitches. I reported the bug and decided not to invest more time hacking around their limitations to get a layout I wasn’t thrilled about.\nThe less sane way to do it I’m too cheap to hire a professional, but maybe I can use their tools? Adobe InDesign is unsurprisingly a popular choice, but I just hear the word ‘Adobe’ and my hand instinctively reaches back to protect my wallet. In retrospect I might have been able to get away with a one-month subscription for the relative deal of $31.49.\nAffinity Publisher makes a well-regarded alternative that people claim is just as powerful. And for $70 you get a real license, none of that subscription BS. I was interested enough to start a free trial, but realized immediately I was in way over my head and had a steep learning curve to climb. If only there was a powerful layout tool I already knew how to use…\nThe way I did it I’ve spent a non-trivial amount of my life positioning divs. It is low on my list of tasks I enjoy, but over the years I’ve gotten pretty good at cajoling bits into place. CSS is a hell of a hammer, and the more I thought about it, the more my book started looking like a nail.\nThat’s right, I decided to lay out a print book using cascading style sheets. You know, like everyone uses on the web. And no one uses in print. Well, almost no one; we’ll get to that later.\nI already had my book rendered out as bunch of HTML files from my robust ebook pipeline. Haha, jk, I wrote a few hundred lines of sloppy Python/BeautifulSoup that transforms my FocusWriter-generated odt file into an ePub suitable for distribution. God bless ebookify.py. Anyhow, I was already waist-deep in the HTML swamp, and had something I could slap a stylesheet on.\nBut CSS isn’t really made for print, right? I mean, sure, like any totally normal person I use @media print to make my HTML resume look better when a recruiter runs off a copy, but laying out a 300+ page novel is a different beast. You’ve got page numbers, persistent headings, special cases for first of a chapter, weird paper-sizing, etc. Can CSS do all this?\nSpoiler: Yes. But you have to push it to the bleeding edge.\nGetting Started I tweaked ebookify.py to output a single concatenated HTML file containing the markup for all the chapters. My initial goal was to write a stylesheet against this that would make a reasonably good looking book when I hit print in Chrome.\nHere’s what I started with:\nLGTM, ship it!\nFonts CSS is great at sticking fonts on things. As a commercial work though, I needed to pay a little more attention to licensing. I wanted a nice serif font for the body text, and a futuristic sans font for the titles/headers.\nBaskerville was an easy pick for the body; it’s a common/modern choice, and the license that comes with my Mac is already good for distribution. I looked up good pairings, saw it next to ‘Futura,’ and fell in love. Then I read Futura’s license.\nLicensed (protected) font. This font must not be modified, embedded, or exchanged in any manner without first obtaining permission of the legal owner.\nD’oh.\nSure, I could pay the $50, but I’ve already come this far for free – I want to get all the way there. Another trip to professor Google suggested Jost as an alternative to Futura. It’s not as perfect as my first-love, but there’s more to a relationship than just looks. Like licenses (okay, so the metaphor breaks down).\nAnyhow, CSS time!\nbody { font-family: \"Baskerville\"; } h2 { text-align: center; font-family: \"Jost\"; } Better(?)\nBasic Layout It still looks like a web-page, it’s time to apply some print conventions. The chapter headings need some room, and maybe a sweet underline. The body text should be a column, with indented paragraphs. That kind of stuff.\nA note on my CSS: Yes, I’m all over the place with my units (Inches! Pixels! Points! Ems!), and there’s no rhyme or reason to the order of my declarations. In my defense: it doesn’t matter. I’m not going to prod with this. No one’s going to be stuck maintaining it. And, god willing, I’ll never have to extend it. But you’re welcome to clean it up for use in your own project.\nh2 { text-align: center; font-family: \"Jost\"; margin-top: 1.4in; margin-bottom: .9in; font-weight: 300; display: inline-block; /* Pad box to position the \"underline\" that's rendered using the border */ padding: 0.1in 0.2in; border-bottom: 1px solid; line-height: 1em; font-size: 15pt; } p { margin:0; text-indent: 1.5em; font-size: 12pt; line-height: 14.3pt; text-align: justify; text-justify: inter-word; word-spacing: -.7px; } p:first-child { text-indent: 0; } .chapter { text-align: left; } Vaguely print-like\nPage Numbers The basic layout is looking okay, but now we’re missing print specific stuff. Page numbers being a big-one, obviously. Dealbreaker for CSS, right?\nWrong!\nCheck out @page, sucka. CSS knows what pages are! And it can count! And there are special sections on the page margin for sticking things like page numbers. It’s almost like someone was thinking about laying out books with CSS.\nOf course, there’s a big difference between “something with a spec” and “something broadly implemented in browsers.” Let’s ask my good friend caniuse\nWoohoo! The dark green of full support.\nAlright, let’s make some pages and page numbers!\nbody { counter-reset: page_num chap_num; } @page { margin-top: .7in; /* Getting an extra .12 inches padding on the bottom from ?? Whatever, hack! */ margin-bottom: .58in; padding: 0; size: 5.5in 8.5in; counter-increment: page_num; @bottom-center { font-family: \"Jost\"; font-weight: 300; content: counter(page_num); font-size: 9pt; position: relative; margin-top: -.35in; } } Umm…\nIt’s the correct size and stuff, but where are my numbers? They’re supported, right? Right? RIGHT??!!?\nWrong.\nOops, there’s a bug. In caniuse, haha. Not Chrome – Chrome has never supported @bottom-center. Ditto goes for Firefox. I cannot use. At least, not all the cool parts.\nI took a little solace that Kevin has been feeling my pain for 18 years, but it still stung.\nSo what now? I’m sunk, right? None of the major browser vendors support the feature I need, and I can’t well have a book without page numbers. But I read through the caniuse bug, and lo:\nedgar444 commented on Jul 13, 2018\n… [snip some CSS about rendering a header using @top-center]\nThere is software like weasyprint that did produce the red boxes.\nQ: What is a weasyprint?\nA: An eldritch invocation for rendering html to pdf that supports a surprising amount of bleeding edge CSS.\nI don’t believe in ‘manifesting,’ or whatever. But I’m pretty sure this software didn’t exist until I willed it to. I fired off a brew install weasyprint and crossed my fingers.\nOne more time with feeling weasing:\nLook at that beautiful page number!\nHeaders Now we’re off to the races. Let’s marginalia all the things!\nOne problem though – I want different headers on the left and right pages. Also different left and right margins, since a lot of the paper gets buried in the binding. Surely CSS doesn’t support– aww, you know I’m only messing. CSS DOES ALL.\n:root { --inside-margin: .75in; --outside-margin: .5in; } @page :left { margin-left: var(--outside-margin); margin-right: var(--inside-margin); @top-center { margin-bottom: -.22in; font-family: \"Jost\"; font-weight: 300; font-size: 9.2pt; content: \"IAN G. MCDOWELL\"; } } @page :right { margin-left: var(--inside-margin); margin-right: var(--outside-margin); @top-center { margin-bottom: -.23in; font-family: \"Jost\"; font-weight: 300; font-size: 10pt; content: \"The Anshar Gambit\"; } } Headers! This is a book! Wait, what’s that chapter doing there starting mid-page…\nMore Bookish Things Anyone that ever word-processed pre-2006 knows that page breaks are a thing. Guess what? CSS breaks pages with the best of them. I’m also going to throw in a sweet custom SVG section break I made.\n.chapter { break-after: always; } .divider { text-align: center; padding: .2in; } .divider img { width: 50%; } Tada, chapters start on new pages. Also, look at that sweet mid-chapter break graphic (No, I’m not a designer. Yes, I’m irrationally proud).\nBut now our header is showing up on the first page of the chapter. That’s not professional. Surely CSS has a way to conditionally hide it?\nActually, no. Not elegantly. At least not that I could find. But I didn’t write CSS for a decade without learning to HACK. We’ll just make our chapter headers exude a giant white box that obliterates everything above them.\nh2::before { content: ''; position: absolute; /* Need a negative offset as our parent is the non-margin parts of the page. */ top: -1in; left: 0; width: 100%; height: 2in; background-color: white; } @page :right { ... @top-center { ... z-index: -1; } } @page :left { ... @top-center { ... z-index: -1; } } Header be gone!\nConclusion There you have it: All the formatting of a traditional print book, achieved in the most asinine way possible. I didn’t get CSS to run doom or anything, but I’m still delighted that I made this work using only HTML, CSS, and a little weasy black magic.\nIt’s even got some advantages; if I change any text, the whole thing automatically reflows. And when I’m ready to send it to the printer, I can dive into the markup to hand-tweak anything that doesn’t look exactly right.\nMy author copies came in the mail today, and they look like… books! I’m holding HTML!\nTotal out-of-pocket cost: $0. It’s like Linux: free so long as your time has no value.\nflippity-flip-flip\nWould I recommend this approach to a friend? Hell no. Just use Vellum like a normal person. Will I share my stylesheet? I mean, I already kind of did, but if you ask nice I suppose I could give it to you as a file. Hit me up – ian@iangmcdowell.com. I will also listen to your angry CSS rants, though I will not help you fix issues :-)\nAnything else? Pitch time!\nIf you like riveting, fast-paced technothrillers with compelling characters, near-future technology, and orbital bombardment, you should check out The Anshar Gambit, available wherever mega-corporation monopolists sell books (read: Amazon). Now in paperback!\nAlternatively/additionally, for those of you embracing the frugal spirit of this post, you can sign up for my mailing list to receive a free digital copy of the prequel novella, The Boreas Gap.\n",
  "wordCount" : "1979",
  "inLanguage": "en",
  "datePublished": "2023-03-19T20:06:35-08:00",
  "dateModified": "2023-03-19T20:06:35-08:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://iangmcdowell.com/blog/posts/laying-out-a-book-with-css/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Ian G McDowell's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://iangmcdowell.com/blog/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://iangmcdowell.com/blog" accesskey="h" title="Ian G McDowell&#39;s Blog (Alt + H)">Ian G McDowell&#39;s Blog</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://iangmcdowell.com/#books" title="The Books">
                    <span>The Books</span>
                </a>
            </li>
            <li>
                <a href="https://iangmcdowell.com/author" title="The Author">
                    <span>The Author</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      Laying Out a Print Book With CSS
    </h1>
    <div class="post-meta"><span title='2023-03-19 20:06:35 -0800 -0800'>March 19, 2023</span>

</div>
  </header> 
  <div class="post-content"><p><img loading="lazy" src="/blog/book_layout_art.png" alt="code book"  />

<em>Obligatory Stable Diffusion image</em></p>
<p>Last year I published my debut technothriller, <a href="https://www.amazon.com/dp/B0BL2JD1LJ">The Anshar Gambit</a>, as an eBook. Satisfying, yes, but I&rsquo;ve spent entirely too much of my life peddling bits. I wanted to <em>hold</em> it. Unsurprisingly, in order to get my book printed, I first needed to submit a pixel-perfect PDF of all the pages. And like any self-respecting nerd, I approached the challenge in the most convoluted way possible.</p>
<h2 id="the-sane-way-to-do-it">The sane way to do it<a hidden class="anchor" aria-hidden="true" href="#the-sane-way-to-do-it">#</a></h2>
<p><img loading="lazy" src="/blog/book_sane.png" alt="sane book"  />
</p>
<p>As you might expect, laying out a book is a solved problem. The simplest solution is to pay a professional. But I have ample time to learn and limited budget, so I wanted a DIY solution.</p>
<p>Most self-publishers use software explicitly built for this task. <a href="https://vellum.pub">Vellum</a> is the gold standard. It is very good and easy to use, and costs just $250. Another contender is <a href="https://www.atticus.io">Atticus</a>, which is pitched as an all-in-one writing platform for a more affordable $147. These are both good options, and while expensive for software, reasonable for the amount of time they save you. But I am a fool with more time than sense/cents, and I knew I could do it cheaper.</p>
<p><a href="https://reedsy.com/">Reedsy</a> offers an online tool that supports a basic print layout. And it&rsquo;s free! That got my attention. I got as far as loading my manuscript into their tool, but hit a rendering bug displaying Latin Extended-A characters in a code-block, plus there were some other minor formatting glitches. I reported the bug and decided not to invest more time hacking around their limitations to get a layout I wasn&rsquo;t thrilled about.</p>
<h2 id="the-less-sane-way-to-do-it">The less sane way to do it<a hidden class="anchor" aria-hidden="true" href="#the-less-sane-way-to-do-it">#</a></h2>
<p><img loading="lazy" src="/blog/book_less_sane.png" alt="less sane book"  />
</p>
<p>I&rsquo;m too cheap to hire a professional, but maybe I can use their tools? <a href="https://www.adobe.com/products/indesign.html">Adobe InDesign</a> is unsurprisingly a popular choice, but I just hear the word &lsquo;Adobe&rsquo; and my hand instinctively reaches back to protect my wallet. In retrospect I might have been able to get away with a one-month subscription for the relative deal of $31.49.</p>
<p><a href="https://affinity.serif.com/en-us/publisher/">Affinity Publisher</a> makes a well-regarded alternative that people claim is just as powerful. And for $70 you get a real license, none of that subscription BS. I was interested enough to start a free trial, but realized immediately I was in way over my head and had a steep learning curve to climb. If only there was a powerful layout tool I already knew how to use…</p>
<h2 id="the-way-i-did-it">The way I did it<a hidden class="anchor" aria-hidden="true" href="#the-way-i-did-it">#</a></h2>
<p><img loading="lazy" src="/blog/book_crazy.png" alt="insane book"  />
</p>
<p>I&rsquo;ve spent a non-trivial amount of my life positioning divs. It is low on my list of tasks I enjoy, but over the years I&rsquo;ve gotten pretty good at cajoling bits into place. CSS is a hell of a hammer, and the more I thought about it, the more my book started looking like a nail.</p>
<p>That&rsquo;s right, I decided to lay out a print book using cascading style sheets. You know, like everyone uses on the web. And no one uses in print. Well, almost no one; we&rsquo;ll get to that later.</p>
<p>I already had my book rendered out as bunch of HTML files from my robust ebook pipeline. Haha, jk, I wrote a few hundred lines of sloppy Python/<a href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/">BeautifulSoup</a> that transforms my <a href="https://gottcode.org/focuswriter/">FocusWriter</a>-generated odt file into an ePub suitable for distribution. God bless <code>ebookify.py</code>. Anyhow, I was already waist-deep in the HTML swamp, and had something I could slap a stylesheet on.</p>
<p>But CSS isn&rsquo;t really made for print, right? I mean, sure, like any totally normal person I use <code>@media print</code> to make my HTML resume look better when a recruiter runs off a copy, but laying out a 300+ page novel is a different beast. You&rsquo;ve got page numbers, persistent headings, special cases for first of a chapter, weird paper-sizing, etc. Can CSS do all this?</p>
<p>Spoiler: Yes. But you have to push it to the bleeding edge.</p>
<h2 id="getting-started">Getting Started<a hidden class="anchor" aria-hidden="true" href="#getting-started">#</a></h2>
<p>I tweaked <code>ebookify.py</code> to output a single concatenated HTML file containing the markup for all the chapters. My initial goal was to write a stylesheet against this that would make a reasonably good looking book when I hit print in Chrome.</p>
<p>Here&rsquo;s what I started with:</p>
<p><img loading="lazy" src="/blog/book_initial.png" alt="basic web layout"  />

<em>LGTM, ship it!</em></p>
<h3 id="fonts">Fonts<a hidden class="anchor" aria-hidden="true" href="#fonts">#</a></h3>
<p>CSS is great at sticking fonts on things. As a commercial work though, I needed to pay a little more attention to licensing. I wanted a nice serif font for the body text, and a futuristic sans font for the titles/headers.</p>
<p>Baskerville was an easy pick for the body; it&rsquo;s a common/modern choice, and the license that comes with my Mac is already good for distribution. I looked up good pairings, saw it next to &lsquo;Futura,&rsquo; and fell in love. Then I read Futura&rsquo;s license.</p>
<blockquote>
<p>Licensed (protected) font. This font must not be modified, embedded, or exchanged in any manner without first obtaining permission of the legal owner.</p>
</blockquote>
<p>D&rsquo;oh.</p>
<p>Sure, I could pay the $50, but I&rsquo;ve already come this far for free – I want to get all the way there. Another trip to professor Google suggested <a href="https://fonts.google.com/specimen/Jost">Jost</a> as an alternative to Futura. It&rsquo;s not as perfect as my first-love, but there&rsquo;s more to a relationship than just looks. Like licenses (okay, so the metaphor breaks down).</p>
<p>Anyhow, CSS time!</p>
<pre tabindex="0"><code>body {
    font-family: &#34;Baskerville&#34;;
}

h2 {
    text-align: center;
    font-family: &#34;Jost&#34;;
 }
</code></pre><p><img loading="lazy" src="/blog/book_fonted.png" alt="web layout with fonts"  />

<em>Better(?)</em></p>
<h3 id="basic-layout">Basic Layout<a hidden class="anchor" aria-hidden="true" href="#basic-layout">#</a></h3>
<p>It still looks like a web-page, it&rsquo;s time to apply some print conventions. The chapter headings need some room, and maybe a sweet underline. The body text should be a column, with indented paragraphs. That kind of stuff.</p>
<p>A note on my CSS: Yes, I&rsquo;m all over the place with my units (Inches! Pixels! Points! Ems!), and there&rsquo;s no rhyme or reason to the order of my declarations. In my defense: it doesn&rsquo;t matter. I&rsquo;m not going to prod with this. No one&rsquo;s going to be stuck maintaining it. And, god willing, I&rsquo;ll never have to extend it. But you&rsquo;re welcome to clean it up for use in your own project.</p>
<pre tabindex="0"><code>h2 {
    text-align: center;
    font-family: &#34;Jost&#34;;  
    margin-top: 1.4in;
    margin-bottom: .9in;
    font-weight: 300;
    display: inline-block; 
    /* Pad box to position the &#34;underline&#34; that&#39;s rendered using the border */
    padding: 0.1in 0.2in;
    border-bottom: 1px solid;
    line-height: 1em;
    font-size: 15pt;
}

p {
    margin:0;
    text-indent: 1.5em;
    font-size: 12pt;
    line-height: 14.3pt;
    text-align: justify;
    text-justify: inter-word;
    word-spacing: -.7px;
}

p:first-child {
    text-indent: 0;
}

.chapter {
    text-align: left;
}
</code></pre><p><img loading="lazy" src="/blog/book_layout.png" alt="print-like layout"  />

<em>Vaguely print-like</em></p>
<h3 id="page-numbers">Page Numbers<a hidden class="anchor" aria-hidden="true" href="#page-numbers">#</a></h3>
<p>The basic layout is looking okay, but now we&rsquo;re missing print specific stuff. Page numbers being a big-one, obviously. Dealbreaker for CSS, right?</p>
<p>Wrong!</p>
<p>Check out <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/@page">@page</a>, sucka. CSS knows what pages are! And it can <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Counter_Styles/Using_CSS_counters">count</a>! And there are special sections on the page margin for sticking things like page numbers. It&rsquo;s almost like someone was <a href="https://www.w3.org/TR/css-page-3/">thinking about laying out books with CSS</a>.</p>
<p>Of course, there&rsquo;s a big difference between &ldquo;something with a spec&rdquo; and &ldquo;something broadly implemented in browsers.&rdquo; Let&rsquo;s ask my good friend <a href="https://caniuse.com/css-paged-media">caniuse</a></p>
<p><img loading="lazy" src="/blog/book_can_i_use.png" alt="caniuse showing support for @page"  />

<em>Woohoo! The dark green of full support.</em></p>
<p>Alright, let&rsquo;s make some pages and page numbers!</p>
<pre tabindex="0"><code>
body {
    counter-reset: page_num chap_num;
}

@page {
    margin-top: .7in;
    /* Getting an extra .12 inches padding on the bottom from ?? Whatever, hack! */
    margin-bottom: .58in;
    padding: 0;
    size: 5.5in 8.5in;
    counter-increment: page_num;

    @bottom-center {
        font-family: &#34;Jost&#34;;
        font-weight: 300;
        content: counter(page_num);
        font-size: 9pt;
        position: relative;
        margin-top: -.35in;
    }
}
</code></pre><p><img loading="lazy" src="/blog/book_page.png" alt="page layout, but page numbers missing"  />

<em>Umm&hellip;</em></p>
<p>It&rsquo;s the correct size and stuff, but where are my numbers? They&rsquo;re supported, right? Right? RIGHT??!!?</p>
<p><a href="https://github.com/Fyrd/caniuse/issues/4034">Wrong.</a></p>
<p>Oops, there&rsquo;s a bug. In caniuse, haha. Not Chrome – <a href="https://bugs.chromium.org/p/chromium/issues/detail?id=320370">Chrome has never supported @bottom-center</a>. Ditto goes for Firefox. I cannot use. At least, not all the cool parts.</p>
<p>I took a little solace that <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=286443">Kevin has been feeling my pain for 18 years</a>, but it still stung.</p>
<p>So what now? I&rsquo;m sunk, right? None of the major browser vendors support the feature I need, and I can&rsquo;t well have a book without page numbers. But I read through the caniuse bug, and lo:</p>
<blockquote>
<p>edgar444 commented on Jul 13, 2018</p>
<p>&hellip; [snip some CSS about rendering a header using @top-center]</p>
<p>There is software like weasyprint that did produce the red boxes.</p>
</blockquote>
<p>Q: What is a <a href="https://weasyprint.org/">weasyprint</a>?</p>
<p>A: An eldritch invocation for rendering html to pdf that supports a surprising amount of bleeding edge CSS.</p>
<p>I don&rsquo;t believe in &lsquo;manifesting,&rsquo; or whatever. But I&rsquo;m pretty sure this software didn&rsquo;t exist until I willed it to. I fired off a <code>brew install weasyprint</code> and crossed my fingers.</p>
<p>One more time with <del>feeling</del> weasing:</p>
<p><img loading="lazy" src="/blog/book_page_weasy.png" alt="page layout with page numbers"  />

<em>Look at that beautiful page number!</em></p>
<h3 id="headers">Headers<a hidden class="anchor" aria-hidden="true" href="#headers">#</a></h3>
<p>Now we&rsquo;re off to the races. Let&rsquo;s marginalia all the things!</p>
<p>One problem though – I want different headers on the left and right pages. Also different left and right margins, since a lot of the paper gets buried in the binding. Surely CSS doesn&rsquo;t support– aww, you know I&rsquo;m only messing. CSS DOES ALL.</p>
<pre tabindex="0"><code>:root {
    --inside-margin: .75in;
    --outside-margin: .5in;
}

@page :left {
    margin-left: var(--outside-margin);
    margin-right: var(--inside-margin);
    @top-center {
        margin-bottom: -.22in;
        font-family: &#34;Jost&#34;;
        font-weight: 300;
        font-size: 9.2pt;
        content: &#34;IAN G. MCDOWELL&#34;;
    }
}

@page :right {
    margin-left: var(--inside-margin);
    margin-right: var(--outside-margin);

    @top-center {
        margin-bottom: -.23in;
        font-family: &#34;Jost&#34;;
        font-weight: 300;
        font-size: 10pt;
        content: &#34;The Anshar Gambit&#34;;
    }
}
</code></pre><p><img loading="lazy" src="/blog/book_headers.png" alt="page layout with headers"  />

<em>Headers! This is a book! Wait, what&rsquo;s that chapter doing there starting mid-page…</em></p>
<h3 id="more-bookish-things">More Bookish Things<a hidden class="anchor" aria-hidden="true" href="#more-bookish-things">#</a></h3>
<p>Anyone that ever word-processed pre-2006 knows that page breaks are a thing. Guess what? CSS breaks pages with the best of them. I&rsquo;m also going to throw in a sweet custom SVG section break I made.</p>
<pre tabindex="0"><code>.chapter {
    break-after: always;
}

.divider {
    text-align: center;
    padding: .2in;
}

.divider img {
    width: 50%;
}
</code></pre><p><img loading="lazy" src="/blog/book_breaks.png" alt="page layout with breaks"  />

Tada, chapters start on new pages. Also, look at that sweet mid-chapter break graphic (No, I&rsquo;m not a designer. Yes, I&rsquo;m irrationally proud).</p>
<p>But now our header is showing up on the first page of the chapter. That&rsquo;s not professional. Surely CSS has a way to conditionally hide it?</p>
<p>Actually, no. Not elegantly. At least not that I could find. But I didn&rsquo;t write CSS for a decade without learning to <em>HACK</em>. We&rsquo;ll just make our chapter headers exude a giant white box that obliterates everything above them.</p>
<pre tabindex="0"><code>h2::before {
    content: &#39;&#39;;
    position: absolute;
    /* Need a negative offset as our parent is the non-margin parts of the page. */
    top: -1in;
    left: 0;
    width: 100%;
    height: 2in;
    background-color: white;
}

@page :right {
    ...
    @top-center {
        ...
        z-index: -1;
    }
}

@page :left {
    ...
    @top-center {
        ...
        z-index: -1;
    }
}
</code></pre><p><img loading="lazy" src="/blog/book_suppress_header.png" alt="header suppressed on new chapter"  />

<em>Header be gone!</em></p>
<h2 id="conclusion">Conclusion<a hidden class="anchor" aria-hidden="true" href="#conclusion">#</a></h2>
<p>There you have it: All the formatting of a traditional print book, achieved in the most asinine way possible. I didn&rsquo;t get CSS to run doom or anything, but I&rsquo;m still delighted that I made this work using only HTML, CSS, and a little weasy black magic.</p>
<p>It&rsquo;s even got some advantages; if I change any text, the whole thing automatically reflows. And when I&rsquo;m ready to send it to the printer, I can dive into the markup to hand-tweak anything that doesn&rsquo;t look exactly right.</p>
<p>My author copies came in the mail today, and they look like&hellip; books!
<img loading="lazy" src="/blog/book_print.jpg" alt="print copy"  />

<em>I&rsquo;m holding HTML!</em></p>
<p>Total out-of-pocket cost: $0. It&rsquo;s like Linux: free so long as your time has no value.</p>
<p><img loading="lazy" src="/blog/book_flip.gif" alt="print copy"  />

<em>flippity-flip-flip</em></p>
<p>Would I recommend this approach to a friend? Hell no. Just use Vellum like a normal person. Will I share my stylesheet? I mean, I already kind of did, but if you ask nice I suppose I could give it to you as a file. Hit me up – <a href="mailto:ian@iangmcdowell.com">ian@iangmcdowell.com</a>. I will also listen to your angry CSS rants, though I will not help you fix issues :-)</p>
<h2 id="anything-else">Anything else?<a hidden class="anchor" aria-hidden="true" href="#anything-else">#</a></h2>
<p>Pitch time!</p>
<p><a href="https://www.amazon.com/dp/B0BL2JD1LJ"><img loading="lazy" src="/blog/anshar_cover.png" alt="The Anshar Gambit book cover"  />
</a></p>
<p>If you like riveting, fast-paced technothrillers with compelling characters, near-future technology, and orbital bombardment, you should check out <a href="https://www.amazon.com/dp/B0BL2JD1LJ">The Anshar Gambit</a>, available wherever mega-corporation monopolists sell books (read: Amazon). Now in paperback!</p>
<p>Alternatively/additionally, for those of you embracing the frugal spirit of this post, you can <a href="https://iangmcdowell.com/">sign up for my mailing list</a> to receive a free digital copy of the prequel novella, The Boreas Gap.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://iangmcdowell.com/blog/tags/writing/">writing</a></li>
      <li><a href="https://iangmcdowell.com/blog/tags/technology/">technology</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2023 <a href="https://iangmcdowell.com/blog">Ian G McDowell&#39;s Blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
